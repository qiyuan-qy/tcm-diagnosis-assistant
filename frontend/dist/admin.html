<!DOCTYPE html>
<html lang='zh-CN'>
<head>
<meta charset='UTF-8'>
<title>çŸ¥è¯†åº“ç®¡ç†</title>
<style>
body{font-family:'Microsoft YaHei';background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px}
.container{max-width:1200px;margin:0 auto}
.header{background:rgba(255,255,255,0.95);padding:30px;border-radius:20px;margin-bottom:20px;text-align:center}
.title{font-size:2.5em;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.tabs{display:flex;gap:10px;margin-bottom:20px}
.tab{flex:1;padding:15px;background:rgba(255,255,255,0.9);border:none;border-radius:10px;cursor:pointer;font-weight:bold}
.tab.active{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white}
.tab-content{background:rgba(255,255,255,0.95);padding:30px;border-radius:20px;display:none}
.tab-content.active{display:block}
.upload-area{border:3px dashed #667eea;border-radius:15px;padding:50px;text-align:center;cursor:pointer}
.btn{padding:12px 30px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;border:none;border-radius:25px;cursor:pointer;font-weight:bold}
.btn-danger{background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%)}
.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px}
.stat-card{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:25px;border-radius:15px;text-align:center}
.stat-number{font-size:2.5em;font-weight:bold}
.doc-item{background:#f8f9fa;padding:20px;border-radius:10px;margin-bottom:15px;display:flex;justify-content:space-between;align-items:center}
.alert{padding:15px;border-radius:10px;margin-bottom:20px;display:none}
.alert.success{background:#d4edda;color:#155724}
.alert.error{background:#f8d7da;color:#721c24}
</style>
</head>
<body>
<div class='container'>
<div class='header'><h1 class='title'>ğŸ“š TCMçŸ¥è¯†åº“ç®¡ç†</h1><p>ä¸Šä¼ å’Œç®¡ç†ä¸­åŒ»çŸ¥è¯†æ–‡æ¡£</p></div>
<div class='tabs'>
<button class='tab active' onclick='switchTab("upload")'>ä¸Šä¼ æ–‡æ¡£</button>
<button class='tab' onclick='switchTab("documents")'>æ–‡æ¡£åˆ—è¡¨</button>
<button class='tab' onclick='switchTab("stats")'>ç»Ÿè®¡ä¿¡æ¯</button>
</div>
<div id='upload-tab' class='tab-content active'>
<div class='alert' id='uploadAlert'></div>
<div class='upload-area' onclick='document.getElementById("fileInput").click()'>
<div style='font-size:60px'>ğŸ“„</div>
<h3>ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„ä¸Šä¼ </h3>
<p>æ”¯æŒ .docx, .md, .pdf æ ¼å¼</p>
<input type='file' id='fileInput' style='display:none' accept='.docx,.md,.pdf' onchange='uploadFile(this.files[0])'>
</div>
</div>
<div id='documents-tab' class='tab-content'>
<div class='alert' id='docAlert'></div>
<div id='docList'></div>
</div>
<div id='stats-tab' class='tab-content'>
<div class='stats-grid'>
<div class='stat-card'><div class='stat-number' id='totalDocs'>-</div><div class='stat-label'>æ€»æ–‡æ¡£æ•°</div></div>
<div class='stat-card'><div class='stat-number' id='totalChunks'>-</div><div class='stat-label'>çŸ¥è¯†å—æ€»æ•°</div></div>
</div>
</div>
</div>
<script>
const API_BASE='/api/v1';
function switchTab(t){document.querySelectorAll('.tab').forEach(e=>e.classList.remove('active'));document.querySelectorAll('.tab-content').forEach(e=>e.classList.remove('active'));event.target.classList.add('active');document.getElementById(t+'-tab').classList.add('active');if(t=='documents')loadDocuments();if(t=='stats')loadStats()}
async function uploadFile(f){if(!f)return;const d=new FormData();d.append('file',f);try{const r=await fetch(API_BASE+'/knowledge/upload',{method:'POST',body:d});const res=await r.json();if(res.status=='success')showAlert('uploadAlert','âœ… '+res.original_filename+' ä¸Šä¼ æˆåŠŸï¼å·²æ·»åŠ  '+res.chunk_count+' ä¸ªçŸ¥è¯†å—','success')}catch(e){showAlert('uploadAlert','âŒ ä¸Šä¼ å¤±è´¥','error')}}
async function loadDocuments(){try{const r=await fetch(API_BASE+'/knowledge/documents');const res=await r.json();document.getElementById('docList').innerHTML=res.documents.map(d=>"<div class='doc-item'><div><strong>ğŸ“„ "+d.filename+"</strong><br><small>ç±»å‹: "+d.type+" | çŸ¥è¯†å—: "+d.chunk_count+"ä¸ª</small></div><button class='btn btn-danger' onclick='deleteDocument(""+d.filename+"")'>åˆ é™¤</button></div>").join('')}catch(e){}}
async function deleteDocument(n){if(!confirm('ç¡®å®šåˆ é™¤ '+n+' å—ï¼Ÿ'))return;try{const r=await fetch(API_BASE+'/knowledge/documents/'+n,{method:'DELETE'});const res=await r.json();if(res.status=='success'){showAlert('docAlert','âœ… å·²åˆ é™¤','success');loadDocuments()}}catch(e){}}
async function loadStats(){try{const r=await fetch(API_BASE+'/knowledge/stats');const res=await r.json();document.getElementById('totalDocs').textContent=res.total_documents;document.getElementById('totalChunks').textContent=res.total_chunks}catch(e){}}
function showAlert(id,msg,type){const el=document.getElementById(id);el.textContent=msg;el.className='alert '+type;el.style.display='block';setTimeout(()=>{el.style.display='none'},5000)}
loadStats();
</script>
</body>
</html>
